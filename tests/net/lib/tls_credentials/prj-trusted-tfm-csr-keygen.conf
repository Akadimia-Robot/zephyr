# Same as prj-trusted-tfm.conf, but enable requirements for CSR and Keygen.

CONFIG_TFM_PARTITION_PROTECTED_STORAGE=y
CONFIG_TLS_CREDENTIALS_BACKEND_PROTECTED_STORAGE=y
CONFIG_HEAP_MEM_POOL_SIZE=1024
CONFIG_TFM_PROFILE_TYPE_NOT_SET=y

# Increased stack size required for crypto operations
CONFIG_ZTEST_STACK_SIZE=8192

# Enable and configure MbedTLS to allow CSR and Keygen using PSA
CONFIG_MBEDTLS=y
CONFIG_MBEDTLS_BUILTIN=y
CONFIG_MBEDTLS_USE_PSA_CRYPTO=y
CONFIG_MBEDTLS_USER_CONFIG_ENABLE=y
CONFIG_MBEDTLS_USER_CONFIG_FILE="user-tls-conf-csr-keygen.h"

# Enable needed PSA features
CONFIG_PSA_WANT_KEY_TYPE_ECC_PUBLIC_KEY=y
CONFIG_PSA_WANT_KEY_TYPE_ECC_KEY_PAIR_IMPORT=y
CONFIG_PSA_WANT_KEY_TYPE_ECC_KEY_PAIR_EXPORT=y
CONFIG_PSA_WANT_ECC_SECP_R1_256=y
CONFIG_PSA_WANT_ALG_ECDSA=y

# Enable TFM (for PSA)
CONFIG_BUILD_WITH_TFM=y
CONFIG_TFM_PROFILE_TYPE_NOT_SET=y
CONFIG_TFM_IPC=y
