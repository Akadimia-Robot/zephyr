sample:
  name: SoC Flash on NRF52
tests:
  test:
    platform_whitelist: nrf52_pca10040
    tags: flash nrf52
    harness: console
    harness_config:
        type: multi_line
        regex:
            - "Nordic nRF5 Flash Testing"
            - "========================="
            - "Test 1: Flash erase page at 0x[0-9a-f]*"
            - "   Flash erase succeeded!"
            - "Test 2: Flash write .word array 1."
            - "   Attempted to write 1122 at 0x[0-9a-f]*"
            - "   Attempted to read 0x[0-9a-f]*"
            - "   Data read: 1122"
            - "   Data read matches data written. Good!"
            - "   Attempted to write aabb at 0x[0-9a-f]*"
            - "   Attempted to read 0x[0-9a-f]*"
            - "   Data read: aabb"
            - "   Data read matches data written. Good!"
            - "   Attempted to write abcd at 0x[0-9a-f]*"
            - "   Attempted to read 0x[0-9a-f]*"
            - "   Data read: abcd"
            - "   Data read matches data written. Good!"
            - "   Attempted to write 1234 at 0x[0-9a-f]*"
            - "   Attempted to read 0x[0-9a-f]*"
            - "   Data read: 1234"
            - "   Data read matches data written. Good!"
            - "Test 3: Flash erase .4 pages at 0x[0-9a-f]*."
            - "   Flash erase succeeded!"
            - "Test 4: Flash write .word array 2."
            - "   Attempted to write 1234 at 0x[0-9a-f]*"
            - "   Attempted to read 0x[0-9a-f]*"
            - "   Data read: 1234"
            - "   Data read matches data written. Good!"
            - "   Attempted to write aabb at 0x[0-9a-f]*"
            - "   Attempted to read 0x[0-9a-f]*"
            - "   Data read: aabb"
            - "   Data read matches data written. Good!"
            - "   Attempted to write abcd at 0x[0-9a-f]*"
            - "   Attempted to read 0x[0-9a-f]*"
            - "   Data read: abcd"
            - "   Data read matches data written. Good!"
            - "   Attempted to write 1122 at 0x[0-9a-f]*"
            - "   Attempted to read 0x[0-9a-f]*"
            - "   Data read: 1122"
            - "   Data read matches data written. Good!"
            - "Test 5: Flash erase page at 0x[0-9a-f]*"
            - "   Flash erase succeeded!"
#            - "Test 6: Non-word aligned write .word array 3."
            - "   Attempted to write 1122 at 0x[0-9a-f]*"
            - "   Attempted to read 0x[0-9a-f]*"
            - "   Data read: 1122"
            - "   Data read matches data written. Good!"
            - "   Attempted to write aabb at 0x[0-9a-f]*"
            - "   Attempted to read 0x[0-9a-f]*"
            - "   Data read: aabb"
            - "   Data read matches data written. Good!"
            - "   Attempted to write abcd at 0x[0-9a-f]*"
            - "   Attempted to read 0x[0-9a-f]*"
            - "   Data read: abcd"
            - "   Data read matches data written. Good!"
            - "   Attempted to write 1234 at 0x[0-9a-f]*"
            - "   Attempted to read 0x[0-9a-f]*"
            - "   Data read: 1234"
            - "   Data read matches data written. Good!"
            - "   Attempted to write 1122 at 0x[0-9a-f]*"
            - "   Attempted to read 0x[0-9a-f]*"
            - "   Data read: 1122"
            - "   Data read matches data written. Good!"
            - "   Attempted to write aabb at 0x[0-9a-f]*"
            - "   Attempted to read 0x[0-9a-f]*"
            - "   Data read: aabb"
            - "   Data read matches data written. Good!"
            - "   Attempted to write abcd at 0x[0-9a-f]*"
            - "   Attempted to read 0x[0-9a-f]*"
            - "   Data read: abcd"
            - "   Data read matches data written. Good!"
            - "   Attempted to write 1234 at 0x[0-9a-f]*"
            - "   Attempted to read 0x[0-9a-f]*"
            - "   Data read: 1234"
            - "   Data read matches data written. Good!"
            - "Test 7: Page layout API"
            - "   Offset  0x00041234:"
            - "     belongs to the page [0-9]* of start offset 0x[0-9a-f]*"
            - "     and the size of 0x[0-9a-f]* B."
            - "   Page of number [0-9]* has start offset 0x[0-9a-f]*"
            - "     and size of 0x00001000 B."
            - "     Page index resolved properly"
            - "   SoC flash consists of [0-9]* pages."
            - "Test 8: Write block size API"
            - "   write-block-size = [0-9]*"
            - "Done"

