# Kconfig - random generator driver configuration options

#
# Copyright (c) 2014-2015 Wind River Systems, Inc.
#
# SPDX-License-Identifier: Apache-2.0
#

menuconfig RANDOM_GENERATOR
	bool
	prompt "Random Drivers"
	default n
	help
	  Include RANDOM drivers in system config.

if RANDOM_GENERATOR

source "drivers/random/Kconfig.mcux"
source "drivers/random/Kconfig.stm32"

config RANDOM_HAS_DRIVER
	bool
	default n
	help
	This is an option to be enabled by individual random driver
	to signal that there is a true random driver.

config RANDOM_POOL
	bool "Enables the random pool"
	select TINYCRYPT
	select TINYCRYPT_AES
	default n
	help
	This adds a device inspired by /dev/random as common on Unices. Various
	sources of entropy can be enabled, including hardware-based random
	number generators usually available as microcontroller peripherals.

	If enabled, this will take over the RANDOM_0 device, and the
	hardware-based random number generators will be named HWRNG_0 instead.
	Either the random_get_entropy() function or sys_rand32_get() can then
	be used to obtain some data.

	An idle priority thread will kick in every now and then to stir a pot
	of integers with the various sources of entropy.  When asked to
	generate random data, this pot and an atomically-increasing integer
	will be used as inputs to an AES encryption routine.  The cyphertext is
	then stirred in the pot, folded into a single integer, and used as
	entropy for random_get_entropy().  (sys_rand32_get() is just a special
	case of random_get_entropy().)

config RANDOM_POOL_SOURCE_DEVICES
	bool "Initialize random pool with device information"
	depends on RANDOM_POOL
	default y
	help
	Use pointers to all `struct device` that were initialized before main()
	gets executed.  While not random, this is unique for every configuration.

config RANDOM_POOL_SOURCE_HARDWARE
	bool "Use hardware-based number generator as entropy source in pool"
	depends on RANDOM_POOL
	depends on RANDOM_HAS_DRIVER
	default y
	help
	Mix values obtained from the hardware random number generator in the pool.

config RANDOM_HARDWARE_NAME
	string "Hardware-based random generator name"
	depends on RANDOM_POOL
	depends on RANDOM_POOL_SOURCE_HARDWARE
	default "HWRNG_0"

config RANDOM_POOL_SOURCE_TIMESTAMP
	bool "Use time stamp as entropy source in random pool"
	depends on RANDOM_POOL
	default y
	help
	Mix the CPU timestamp in the pool.

config RANDOM_POOL_SOURCE_CYCLE_COUNTER
	bool "Use cycle counter as entropy source in random pool"
	depends on RANDOM_POOL
	default y
	help
	Mix the CPU cycle count in the pool.

config RANDOM_NAME
	string "Random device name"
	depends on RANDOM_GENERATOR
	default "RANDOM_0"
	help
	Specify the device name to be used for the RANDOM driver.

config SYS_LOG_RANDOM_LEVEL
	int "Random Log level"
	depends on SYS_LOG && RANDOM_GENERATOR
	default 0
	range 0 4
	help
	  Sets log level for random driver.
	  Levels are:
	  - 0 OFF: do not write
	  - 1 ERROR: only write SYS_LOG_ERR
	  - 2 WARNING: write SYS_LOG_WRN in addition to previous level
	  - 3 INFO: write SYS_LOG_INF in addition to previous levels
	  - 4 DEBUG: write SYS_LOG_DBG in addition to previous levels

config TEST_RANDOM_GENERATOR
	bool
	prompt "Non-random number generator"
	depends on RANDOM_GENERATOR && !RANDOM_HAS_DRIVER && !RANDOM_POOL
	default n
	help
	  This option signifies that the kernel's random number APIs are
	  permitted to return values that are not truly random.
	  This capability is provided for testing purposes, when a truly random
	  number generator is not available. The non-random number generator
	  should not be used in a production environment.

config X86_TSC_RANDOM_GENERATOR
	bool
	prompt "x86 timestamp counter based number generator"
	depends on TEST_RANDOM_GENERATOR && X86
	default y
	help
	  This options enables number generator based on timestamp counter
	  of x86 boards, obtained with rdtsc instruction.

config TIMER_RANDOM_GENERATOR
	bool
	prompt "System timer clock based number generator"
	depends on TEST_RANDOM_GENERATOR && !X86_TSC_RANDOM_GENERATOR
	default y
	help
	  This options enables number generator based on system timer
	  clock. This number generator is not random and used for
	  testing only.

endif
