# Copyright (c) 2020 Linumiz
# SPDX -License-Identifier: Apache-2.0

menuconfig HAWKBIT
	bool "Hawkbit Firmware Over-the-Air support"
	depends on NVS
	depends on FLASH
	depends on REBOOT
	depends on HWINFO
	depends on NET_TCP
	depends on NET_SOCKETS
	depends on IMG_MANAGER
	depends on NETWORKING
	depends on HTTP_CLIENT
	depends on DNS_RESOLVER
	depends on JSON_LIBRARY
	depends on BOOTLOADER_MCUBOOT
	select MPU_ALLOW_FLASH_WRITE
	select IMG_ENABLE_IMAGE_CHECK
	select IMG_ERASE_PROGRESSIVELY
	help
	  Hawkbit is a domain independent back-end framework for polling out
	  software updates to constrained edge devices as well as more powerful
	  controllers and gateways connected to IP based networking infrastructure.

if HAWKBIT
config HAWKBIT_POLL_INTERVAL
	int "Time to poll interval (in minutes)"
	default 5
	range 1 43200
	help
	  Set the interval that the hawkbit update server will be polled.
	  This time interval is zero and 43200 minutes(30 days).

config HAWKBIT_SHELL
	bool "Hawkbit shell utilities"
	depends on SHELL
	help
	  Activate shell module that provides Hawkbit commands.

config HAWKBIT_SERVER
	string "User address for the hawkbit server"
	default ""
	help
	  Configure the hawkbit server address.

config HAWKBIT_PORT
	string "Port address for the hawkbit server"
	default "8080"
	help
	  Configure the hawkbit port number.

config HAWKBIT_HWREVISION_SIZE
	int "Size for hardware revision attribute"
	default 10
	help
		Configure the size of the hardware revision attribute.

config HAWKBIT_CUSTOM_ATTRIBUTE_AMOUNT
	int "Amount of custom attributes"
	default 0
	range 0 4
	help
		Configure the amount of custom attributes that will be used in the hawkbit server.

config HAWKBIT_CUSTOM_ATTRIBUTE_0
	bool "Emable first custom attribute"
	default HAWKBIT_CUSTOM_ATTRIBUTE_AMOUNT >= 1
	help
		Enable the first custom attribute.

if HAWKBIT_CUSTOM_ATTRIBUTE_0

	config HAWKBIT_CUSTOM_ATTRIBUTE_0_NAME
		string "Custom name for first custom attribute"
		default "custom_0"
		help
			Configure the name of the first custom attribute.

	config HAWKBIT_CUSTOM_ATTRIBUTE_0_SIZE
		int "Size for first custom attribute"
		default 10
		help
			Configure the size of the first custom attribute.
endif

config HAWKBIT_CUSTOM_ATTRIBUTE_1
	bool "Emable second custom attribute"
	default HAWKBIT_CUSTOM_ATTRIBUTE_AMOUNT >= 2
	help
		Enable the second custom attribute.

if HAWKBIT_CUSTOM_ATTRIBUTE_1

	config HAWKBIT_CUSTOM_ATTRIBUTE_1_NAME
		string "Custom name for second custom attribute"
		default "custom_1"
		help
			Configure the name of the second custom attribute.

	config HAWKBIT_CUSTOM_ATTRIBUTE_1_SIZE
		int "Size for second custom attribute"
		default 10
		help
			Configure the size of the second custom attribute.

endif

config HAWKBIT_CUSTOM_ATTRIBUTE_2
	bool "Emable third custom attribute"
	default HAWKBIT_CUSTOM_ATTRIBUTE_AMOUNT >= 3
	help
		Enable the third custom attribute.

if HAWKBIT_CUSTOM_ATTRIBUTE_2

	config HAWKBIT_CUSTOM_ATTRIBUTE_2_NAME
		string "Custom name for third custom attribute"
		default "custom_2"
		help
			Configure the name of the third custom attribute.

	config HAWKBIT_CUSTOM_ATTRIBUTE_2_SIZE
		int "Size for third custom attribute"
		default 10
		help
			Configure the size of the third custom attribute.

endif

config HAWKBIT_CUSTOM_ATTRIBUTE_3
	bool "Emable fourth custom attribute"
	default HAWKBIT_CUSTOM_ATTRIBUTE_AMOUNT >= 4
	help
		Enable the fourth custom attribute.

if HAWKBIT_CUSTOM_ATTRIBUTE_3

	config HAWKBIT_CUSTOM_ATTRIBUTE_3_NAME
		string "Custom name for fourth custom attribute"
		default "custom_3"
		help
			Configure the name of the fourth custom attribute.

	config HAWKBIT_CUSTOM_ATTRIBUTE_3_SIZE
		int "Size for fourth custom attribute"
		default 10
		help
			Configure the size of the fourth custom attribute.

endif

choice HAWKBIT_DDI_SECURITY
	prompt "Hawkbit DDI API authentication modes"
	default HAWKBIT_DDI_NO_SECURITY

config HAWKBIT_DDI_NO_SECURITY
	bool "No authentication security"
	help
	  No authentication security for the Hawkbit DDI API.

config HAWKBIT_DDI_TARGET_SECURITY
	bool "Use target security token authentication"
	help
	  Use target security token authentication for the Hawkbit DDI API.

config HAWKBIT_DDI_GATEWAY_SECURITY
	bool "Use gateway security token authentication"
	help
	  Use gateway security token authentication for the Hawkbit DDI API.

endchoice

config HAWKBIT_DDI_SECURITY_TOKEN
	string "Authentication security token"
	depends on HAWKBIT_DDI_TARGET_SECURITY || HAWKBIT_DDI_GATEWAY_SECURITY
	default ""
	help
	  Authentication security token for the configured Hawkbit DDI
	  authentication mode.

module = HAWKBIT
module-str = Log Level for hawkbit
module-help = Enables logging for Hawkbit code.
source "subsys/logging/Kconfig.template.log_config"

endif
