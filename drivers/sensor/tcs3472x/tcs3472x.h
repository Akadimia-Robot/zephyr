/*
 * Copyright (c) 2023, Thomas Kiss <thokis@gmail.com>
 *
 * SPDX-License-Identifier: Apache-2.0
 */

#ifndef ZEPHYR_DRIVERS_SENSOR_TCS3472X_TCS3472X_H_
#define ZEPHYR_DRIVERS_SENSOR_TCS3472X_TCS3472X_H_

#include <zephyr/types.h>
#include <zephyr/device.h>
#include <zephyr/devicetree.h>
#include <zephyr/drivers/i2c.h>

#define DT_DRV_COMPAT ams_tcs3472x

#define TCS3472X_BUS_I2C DT_ANY_INST_ON_BUS_STATUS_OKAY(i2c)

struct tcs3472x_data {
	uint16_t sample_crgb[4];
};

struct tcs3472x_config {
	struct i2c_dt_spec i2c;
	uint32_t again;
	uint32_t atime;
	uint32_t int_time;
};

#define TCS_34721_34725 (0x44)
#define TCS_34723_34727 (0x4D)

#define TCS3472X_COMMAND_BIT (0x80)
#define TCS3472X_ENABLE (0x00)
#define TCS3472X_ENABLE_AIEN (0x10)
#define TCS3472X_ENABLE_WEN (0x08)
#define TCS3472X_ENABLE_AEN (0x02)
#define TCS3472X_ENABLE_PON (0x01)
#define TCS3472X_ATIME (0x01)
#define TCS3472X_WTIME (0x03)
#define TCS3472X_WTIME_2_4MS (0xFF)
#define TCS3472X_WTIME_204MS (0xAB)
#define TCS3472X_WTIME_614MS (0x00)
#define TCS3472X_AILTL (0x04)
#define TCS3472X_AILTH (0x05)
#define TCS3472X_AIHTL (0x06)
#define TCS3472X_AIHTH (0x07)
#define TCS3472X_PERS (0x0C)
#define TCS3472X_PERS_NONE (0b0000)
#define TCS3472X_PERS_1_CYCLE (0b0001)
#define TCS3472X_PERS_2_CYCLE (0b0010)
#define TCS3472X_PERS_3_CYCLE (0b0011)
#define TCS3472X_PERS_5_CYCLE (0b0100)
#define TCS3472X_PERS_10_CYCLE (0b0101)
#define TCS3472X_PERS_15_CYCLE (0b0110)
#define TCS3472X_PERS_20_CYCLE (0b0111)
#define TCS3472X_PERS_25_CYCLE (0b1000)
#define TCS3472X_PERS_30_CYCLE (0b1001)
#define TCS3472X_PERS_35_CYCLE (0b1010)
#define TCS3472X_PERS_40_CYCLE (0b1011)
#define TCS3472X_PERS_45_CYCLE (0b1100)
#define TCS3472X_PERS_50_CYCLE (0b1101)
#define TCS3472X_PERS_55_CYCLE (0b1110)
#define TCS3472X_PERS_60_CYCLE (0b1111)
#define TCS3472X_CONFIG (0x0D)
#define TCS3472X_CONFIG_WLONG (0x02)
#define TCS3472X_CONTROL (0x0F)
#define TCS3472X_REG_ID (0x12)
#define TCS3472X_STATUS (0x13)
#define TCS3472X_STATUS_AINT (0x10)
#define TCS3472X_STATUS_AVALID (0x01)
#define TCS3472X_CDATAL (0x14)
#define TCS3472X_CDATAH (0x15)
#define TCS3472X_RDATAL (0x16)
#define TCS3472X_RDATAH (0x17)
#define TCS3472X_GDATAL (0x18)
#define TCS3472X_GDATAH (0x19)
#define TCS3472X_BDATAL (0x1A)
#define TCS3472X_BDATAH (0x1B)

#define TCS3472X_GAIN_1X (0)
#define TCS3472X_GAIN_4X (4)
#define TCS3472X_GAIN_16X (16)
#define TCS3472X_GAIN_60X (60)
#define TCS3472X_AGAIN_1X (0x00)
#define TCS3472X_AGAIN_4X (0x01)
#define TCS3472X_AGAIN_16X (0x02)
#define TCS3472X_AGAIN_60X (0x03)

#endif /* ZEPHYR_DRIVERS_SENSOR_TCS3472X_TCS3472X_H_ */
