sample:
  name: SoC Flash on nRF52 and nRF91
tests:
  sample.drivers.flash.soc_flash_nrf:
    # Below will allow any platforms that have specified nRF SoC
    # and will not restrict selection to Nordic DK boards.
    filter: (dt_compat_enabled("nordic,nrf52-flash-controller") or
             dt_compat_enabled("nordic,nrf91-flash-controller"))
    integration_platforms:
      - nrf52dk_nrf52832
    extra_args: DTC_OVERLAY_FILE="test_partitions.overlay"
    tags: flash nrf52 nrf9160
    harness: console
    harness_config:
      fixture: external_flash
      type: multi_line
      ordered: true
      regex:
        - "Flash erase succeeded"
        - "Data read: 1234"
        - "Data read matches data written. Good!"
        - "Flash erase succeeded"
        - "Data read: 1122"
        - "Data read matches data written. Good!"
        - "Flash erase succeeded"
        - "Data read: 1234"
        - "Data read: 1234"
        - "Data read matches data written. Good!"
        - "SoC flash consists of \\d+ pages."
        - "write-block-size = 1"
